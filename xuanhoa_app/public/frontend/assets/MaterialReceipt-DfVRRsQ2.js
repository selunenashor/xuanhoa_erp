import{g as M,r as d,o as N,x as h,c as r,a as e,b as V,w as I,e as S,h as B,i as p,j as v,v as y,F as f,l as _,t as u,m as T,f as n}from"./index-D7PpSP6X.js";const U={class:"min-h-screen bg-gray-100"},R={class:"bg-xh-red text-white shadow-lg"},j={class:"container mx-auto px-4 py-4 flex items-center"},D={class:"container mx-auto px-4 py-6"},E={class:"bg-white rounded-lg shadow p-6"},F={key:0,class:"mt-2 border rounded-lg divide-y"},A=["onClick"],K={class:"font-medium"},L={class:"text-sm text-gray-500"},P={key:0,class:"bg-gray-50 rounded-lg p-4"},W={class:"font-medium"},$={class:"text-sm text-gray-500"},z=["value"],G={key:1,class:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg"},H={key:2,class:"bg-green-50 border border-green-200 text-green-600 px-4 py-3 rounded-lg"},J=["disabled"],O={key:0},Q={key:1},ee={__name:"MaterialReceipt",setup(X){const o=M({item_code:"",qty:null,warehouse:"",rate:null}),m=d(!1),i=d(""),g=d(""),c=d([]),a=d(null),x=d([]);N(async()=>{try{x.value=await h.getWarehouses(0)}catch(l){console.error("Error loading warehouses:",l)}});let b=null;const k=()=>{if(a.value=null,clearTimeout(b),o.item_code.length<2){c.value=[];return}b=setTimeout(async()=>{try{c.value=await h.searchItems(o.item_code)}catch(l){console.error("Search error:",l)}},300)},w=l=>{a.value=l,o.item_code=l.item_code,c.value=[]},q=async()=>{i.value="",g.value="",m.value=!0;try{const l=await h.createMaterialReceipt(o.item_code,o.qty,o.warehouse,o.rate);l.success?(g.value=l.message,o.item_code="",o.qty=null,o.rate=null,a.value=null):i.value=l.message}catch(l){i.value=l.message||"Có lỗi xảy ra"}finally{m.value=!1}};return(l,t)=>{const C=S("router-link");return n(),r("div",U,[e("header",R,[e("div",j,[V(C,{to:"/",class:"mr-4"},{default:I(()=>[...t[4]||(t[4]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),_:1}),t[5]||(t[5]=e("h1",{class:"text-xl font-bold"},"Nhập kho",-1))])]),e("main",D,[e("div",E,[e("form",{onSubmit:B(q,["prevent"]),class:"space-y-6"},[e("div",null,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Mã hàng hóa *",-1)),v(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.item_code=s),type:"text",required:"",onInput:k,class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-xh-red",placeholder:"Nhập mã hoặc tên hàng..."},null,544),[[y,o.item_code]]),c.value.length>0?(n(),r("div",F,[(n(!0),r(f,null,_(c.value,s=>(n(),r("div",{key:s.item_code,onClick:Y=>w(s),class:"px-4 py-3 hover:bg-gray-50 cursor-pointer"},[e("div",K,u(s.item_code),1),e("div",L,u(s.item_name),1)],8,A))),128))])):p("",!0)]),a.value?(n(),r("div",P,[t[7]||(t[7]=e("div",{class:"text-sm text-gray-500"},"Đã chọn:",-1)),e("div",W,u(a.value.item_code)+" - "+u(a.value.item_name),1),e("div",$,"Đơn vị: "+u(a.value.stock_uom),1)])):p("",!0),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Số lượng *",-1)),v(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>o.qty=s),type:"number",min:"0.01",step:"0.01",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-xh-red",placeholder:"Nhập số lượng"},null,512),[[y,o.qty,void 0,{number:!0}]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Kho nhập *",-1)),v(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>o.warehouse=s),required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-xh-red"},[t[9]||(t[9]=e("option",{value:""},"-- Chọn kho --",-1)),(n(!0),r(f,null,_(x.value,s=>(n(),r("option",{key:s.name,value:s.name},u(s.warehouse_name||s.name),9,z))),128))],512),[[T,o.warehouse]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Đơn giá (tùy chọn)",-1)),v(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>o.rate=s),type:"number",min:"0",step:"100",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-xh-red",placeholder:"Để trống sẽ lấy giá mặc định"},null,512),[[y,o.rate,void 0,{number:!0}]])]),i.value?(n(),r("div",G,u(i.value),1)):p("",!0),g.value?(n(),r("div",H,u(g.value),1)):p("",!0),e("button",{type:"submit",disabled:m.value||!a.value,class:"w-full bg-xh-red text-white py-4 rounded-lg font-medium text-lg hover:bg-red-700 transition disabled:opacity-50"},[m.value?(n(),r("span",O,"Đang xử lý...")):(n(),r("span",Q,"Nhập kho"))],8,J)],32)])])])}}};export{ee as default};
